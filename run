#!/usr/bin/env python

from pcgen import find_all_pathfinder_spells
from pcgen.qa import QASpellSourceWeb

spells = find_all_pathfinder_spells()

print("Found total of %d spells in Pathfinder" % len(spells))

qs = QASpellSourceWeb()
result = qs.test(spells)

print("Found total of %d spells in Pathfinder with errors" % len(result))

by_source = {}

for (spell, error) in result:
    if spell.sourcelong not in by_source:
        by_source[spell.sourcelong] = {}

    by_source[spell.sourcelong][spell] = error

for source in sorted(by_source.iterkeys()):
    print
    print
    print source
    print "=" * len(source or "None")
    print

    for spell in sorted(by_source[source].iterkeys()):
        name = spell.key or spell.name
        print " 1. %s: %s" % (name, by_source[source][spell])
